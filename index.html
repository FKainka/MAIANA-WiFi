<!DOCTYPE html>
<html>

<head>
    <title>MAIANA</title>
    <style>
        body {
            align-items: center;
            background-color: #000;
            justify-content: center;
            font-family: sans-serif;
            font-size: 18px;
            color: #eee;
            width: 90%;
            max-width: 600px;
        }

        form {
            display: block;
            background-color: #15172b;
            border-radius: 20px;
            box-sizing: border-box;
            padding: 20px;
            margin: 20px;
        }

        h1 {
            display: block;
            border-radius: 20px;
            box-sizing: border-box;
            text-align: center;
            padding: 20px;
            margin: 20px;
            align-items: center;
            color: #eee;
            font-family: sans-serif;
            font-size: 36px;
            font-weight: 600;
        }

        #infobox {
            display: block;
            background-color: #15172b;
            border-radius: 20px;
            box-sizing: border-box;
            text-align: center;
            padding: 20px;
            margin: 20px;
            align-items: center;
            color: #eee;
        }

        legend {
            color: #eee;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 10px;
        }

        input {
            background-color: #303245;
            border-radius: 12px;
            border: 0;
            box-sizing: border-box;
            color: #eee;
            font-size: 18px;
            height: 100%;
            outline: 0;
            padding: 4px 20px 0;
            width: 100%;
        }

        select {
            appearance: none;
            min-height: 50px;
            width: 100%;
            margin-bottom: 20px;
            background-color: #303245;
            border-radius: 12px;
            border: 0;
            box-sizing: border-box;
            color: #eee;
            font-size: 18px;
            height: 100%;
            outline: 0;
            padding: 4px 20px 0;
        }

        input[type=text],
        [type=number] {
            min-height: 50px;
            position: center;
            width: 100%;
            margin-bottom: 20px;
        }

        input[type=radio] {
            display: none;
            margin: 10px;
        }

        input[type=radio]+label {
            border-radius: 12px;
            text-align: center;
            height: 50px;
            display: grid;
            margin-top: 20px;
            margin-bottom: 5px;
            background-color: #303245;
            border-color: #ddd;
            padding: 4px 20px 0;
            width: 100%;
            align-items: center;
        }

        input[type=radio]:checked+label {
            background-color: #06b;
        }

        .radioButtons {
            display: flex;
            justify-content: space-around;
        }

        button {
            background-color: #08d;
            border-radius: 12px;
            border: 0;
            box-sizing: border-box;
            color: #eee;
            cursor: pointer;
            font-size: 18px;
            height: 50px;
            margin-top: 20px;
            margin-bottom: 5px;
            outline: 0;
            text-align: center;
            width: 100%;
        }

        button:active {
            background-color: #06b;
        }
    </style>
</head>

<body>
    <h1>MAIANA</h1>
    <div id="infobox">
        <div id="infotext">
        </div>
        <button type="button" id="refresh">load config</button>
    </div>
    <div>
        <form>
            <fieldset>
                <legend>WiFi settings</legend>

                <div class="radioButtons">
                    <input type="radio" id="wifi-ap" name="wifi" value="ap" checked>
                    <label for="wifi-ap">Access Point</label>

                    <input type="radio" id="wifi-sta" name="wifi" value="sta">
                    <label for="wifi-sta">Client</label>
                </div>

                <label for="wifi-ssid">SSID</label>
                <input type="text" id="wifi-ssid" name="ssid" value="MAIANA" maxlength="32" required>

                <label for="wifi-password">password</label>
                <input type="text" id="wifi-password" name="password" value="" maxlength="63" required>

                <button type="button" id="wifi-genpw">Generate password</button>

                <button type="button" id="wifi-set">SET</button>
            </fieldset>
        </form>
    </div>
    <div>
        <form>
            <fieldset>
                <legend>NMEA0183 forwarding</legend>

                <div class="radioButtons">
                    <input type="radio" id="protocol-none" name="protocol" value="none" checked>
                    <label for="protocol-none">NONE</label>

                    <input type="radio" id="protocol-tcp" name="protocol" value="tcp">
                    <label for="protocol-tcp">TCP</label>

                    <input type="radio" id="protocol-udp" name="protocol" value="udp">
                    <label for="protocol-udp">UDP</label>
                </div>

                <label for="protocol-port">port</label>
                <input type="number" id="protocol-port" name="port" value="10110" min="1" max="65536">

                <button type="button" id="protocol-set">SET</button>
            </fieldset>
        </form>
    </div>
    <div>
        <form>
            <fieldset>
                <legend>Station data</legend>

                <label for="station-mmsi">MMSI</label>
                <input type="text" id="station-mmsi" name="station-mmsi" value="" pattern="[0-9]{9}" required>

                <label for="station-callsign">call sign</label>
                <input type="text" id="station-callsign" name="station-callsign" value="" pattern="[0-9A-Z]" required>

                <label for="station-vesseltype">vessel type</label>
                <select id="station-vesseltype">
                    <option value="34">Diving</option>
                    <option value="30">Fishing</option>
                    <option value="37" selected>Pleasure craft</option>
                    <option value="36">Sailing</option>
                </select>

                <label for="station-loa">LOA (meter)</label>
                <input type="number" id="station-loa" name="station-loa" value="" min="1" required>

                <label for="station-beam">beam (meter)</label>
                <input type="number" id="station-beam" name="station-beam" value="" min="1" required>

                <label for="station-portoffset">port offset (meter)</label>
                <input type="number" id="station-portoffset" name="station-portoffset" value="" min="0" required>

                <label for="station-bowoffset">bow offset (meter)</label>
                <input type="number" id="station-bowoffset" name="station-bowoffset" value="" min="0" required>

                <button type="button" id="station-set">SET</button>
            </fieldset>
        </form>
    </div>
    <script>
        function get(url, params) {
            url += '?' + new URLSearchParams(params).toString();

            return fetch(url).then(data => data.json());
        }

        document.getElementById('wifi-set').onclick = function () {
            let type = document.querySelector('input[name="wifi"]:checked').value;
            let ssid = document.getElementById('wifi-ssid').value;
            let password = document.getElementById('wifi-password').value;

            get("/wifi", { "type": type, "ssid": ssid, "password": password }).then(data => {
            });
        };
        document.getElementById('wifi-genpw').onclick = function () {
            document.getElementById('wifi-password').value = Math.random().toString(36).substr(2, 16);
        };

        document.getElementById('protocol-set').onclick = function () {
            let type = document.querySelector('input[name="protocol"]:checked').value;
            let port = document.getElementById('protocol-port').value;

            get("/protocol", { "type": type, "port": port }).then(data => {
            });
        };

        document.getElementById('station-set').onclick = function () {
            let mmsi = document.getElementById('station-mmsi').value;
            let callsign = document.getElementById('station-callsign').value;
            let vesseltype = document.getElementById('station-vesseltype').value;
            let loa = document.getElementById('station-loa').value;
            let beam = document.getElementById('station-beam').value;
            let portoffset = document.getElementById('station-portoffset').value;
            let bowoffset = document.getElementById('station-bowoffset').value;

            get("/station", { "mmsi": mmsi, "callsign": callsign, "vesseltype": vesseltype, "loa": loa, "beam": beam, "portoffset": portoffset, "bowoffset": bowoffset }).then(data => {
            });
        };

        document.getElementById('refresh').onclick = function () {
            get("/info").then(data => {
                let output = "";
                for (const key in data) {
                    if (Object.hasOwnProperty.call(data, key)) {
                        const element = data[key];
                        output += key + ": " + element + "<br>";
                    }
                }
                document.getElementById('infotext').innerHTML = output;
            });
            get("/wifi").then(data => {
                document.getElementById('wifi-' + data.type).checked = true;
                document.getElementById('wifi-ssid').value = data.ssid;
                document.getElementById('wifi-password').value = data.password;
            });
            get("/protocol").then(data => {
                document.getElementById('protocol-' + data.type).checked = true;
                document.getElementById('protocol-port').value = data.port;
            });
            get("/station").then(data => {
                document.getElementById('station-mmsi').value = data.mmsi;
                document.getElementById('station-callsign').value = data.callsign;
                document.getElementById('station-vesseltype').value = data.vesseltype;
                document.getElementById('station-loa').value = data.loa;
                document.getElementById('station-beam').value = data.beam;
                document.getElementById('station-portoffset').value = data.portoffset;
                document.getElementById('station-bowoffset').value = data.bowoffset;
            });
        };
    </script>
</body>

</html>